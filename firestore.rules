rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // This rule applies to the games collection itself and all documents within it
    match /games/{document=**} {
      allow read: if request.auth.uid != null;
      allow write: if false;
    }

    // A more specific rule for the playerData subcollection. This overrides the parent.
    match /games/{gameId}/playerData/{userId} {
      // A user can only read their own private player data.
      allow read: if request.auth.uid != null && request.auth.uid == userId;

      // Client-side writes are forbidden.
      allow write: if false;
    }
  }
}
